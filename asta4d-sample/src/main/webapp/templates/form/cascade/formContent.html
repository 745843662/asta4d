<html>
<head>
<meta charset="utf-8" />
</head>
<body>
<script>
function addJob(){
	var personId = $("[name=id]").val();
	if(!personId){
		personId = "-1";
	}
	
	var jobLengthElem = $("[name='job-experience-length']");
	var jobLength = parseInt(jobLengthElem.val());
	
	var templateElem = $("[cascade-ref='job-experience-row-@']");
	templateElem = templateElem.clone();
	templateElem.css("display", "");
	
	templateElem.find("[name='job-person-id-@']").val(personId);
	
	var templateStr = $("<div>").append(templateElem).html();
	templateStr = templateStr.replace(/@/g, jobLength);

	$("#job-experience").append(templateStr);
	
	jobLength++;
	jobLengthElem.val(jobLength);
	

}
function removeJob(targetBtn){
	var targetRef = $(targetBtn).attr("cascade-ref-target");
	$("[cascade-ref='" + targetRef+"']").remove();
	return false;
}
</script>
<afd:snippet render="form.CascadeFormSnippet">
<table border=0 class="form-input-table">
	<tr><td>name:</td><td class="name"><input name="name" type="text"/></td></tr>
	<tr><td>age:</td><td class="age"><input name="age" type="text"/></td></tr>
	<tr><td>sex:</td><td class="sex"><input id="sex" name="sex" type="radio"/><label for="sex">M</label></td></tr>
	<tr><td>bloodtype:</td><td class="bloodtype">
		<select id="bloodtype" name="bloodtype">
			<option value="A">A</option>
			<option value="R" afd:clear>R</option>
		</select>
	</td></tr>
	<tr><td>language:</td><td class="language"><input id="language" name="language" type="checkbox"/><label for="language">M</label></td></tr>
	<tr><td>memo:</td><td class="memo">
	<textarea name="memo"></textarea>
	</td></tr>
	<tr>
		<td>job experiences:</td>
		<td>
			<div id="job-experience-err-msg" style="color: red"></div>
			<div id="job-experience">
				<div cascade-ref="job-experience-row-@">
					<input type="hidden" name="job-id-@">
					<input type="hidden" name="job-person-id-@">
					year:<input type="text" name="job-year-@">
					desc:<input type="text" name="job-description-@">
					<a href="javascript:void(0)" onclick="removeJob(this)" cascade-ref-target="job-experience-row-@" class="glyphicon glyphicon-minus"></a>
				</div>
			</div>
			<a id="job-experience-add-btn" href="javascript:addJob()" class="glyphicon glyphicon-plus"></a>
		</td>
	</tr>
</table>
<input type="hidden" id="id" name="id">
<input type="hidden" name="job-experience-length" value="0">
</afd:snippet>
</body>
</html>